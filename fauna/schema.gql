type Query {
  user: User @resolver(name: "current_user")
  # Discover campaigns listing
  discover: [Campaign] @index(name: "campaigns")
  # Campaigns listing
  campaigns: [Campaign]
    @resolver(name: "campaigns_by_user_type", paginated: true)
}

type Mutation {
  login(email: String!, password: String!): Auth @resolver(name: "user_login")
  register(email: String!, password: String!, type: UserType!): User
    @resolver(name: "register")
}

type Auth @embedded {
  secret: String!
}

type Media @embedded {
  url: String!
}

enum UserType {
  BRAND
  INFLUENCER
}

type User {
  name: String
  avatar: Media
  email: String! @unique

  type: UserType!

  # User created Campaigns
  campaigns: [Campaign] @relation

  # User applications/requests to
  # join Campaigns
  bookings: [Booking] @relation

  threads: [Thread] @relation
}

type Campaign {
  # the brand who created the campaign
  user: User

  name: String
  description: String
  dueDate: Date
  private: Boolean
  budget: Float
  bookings: [Booking] @relation
}

enum BookingState {
  ACCEPTED
  DECLINED
  COMPLETE

  # For when an influencer applies
  # to a campaign
  APPLIED

  # For when an brand requests
  # an influencer onto a campaign
  REQUESTED
}

type Booking {
  campaign: Campaign!
  user: User!
  cost: Float!
  state: BookingState!
}

type Thread {
  users: [User] @relation
  messages: [Message] @relation
}

type Message {
  thread: Thread!
  user: User!
  text: String!
}
